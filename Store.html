<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jowaki Store - Complete E-commerce System</title>
    <link rel="stylesheet" href="store.css">
</head>
<body>
    <!-- Top Navigation -->
    <nav class="top-nav">
        <div class="nav-container">
            <div class="logo-container">
                <img src="Logo.jpg" alt="Jowaki Logo" class="logo-img">
                <a href="#" class="logo" onclick="showHome()">Jowaki Store</a>
            </div>
            <nav class="nav-links">
                    <a href="Index.html" class="nav-link">Home</a>
                    <a href="Service.html" class="nav-link">Services</a>
                    <a href="Store.html" class="nav-link shop-link">üõí Shop</a>
                    <a href="login.html" class="nav-link login-link">üë§ Login</a>
                </nav>
                <div class="search-container">
                    <input type="text" class="search-input" id="searchInput" placeholder="Search products...">
                    <button class="search-btn" onclick="searchProducts()">üîç</button>
                </div>
            </div>
        </div>
    </nav>

    <div id="app">
        <!-- Notification -->
        <div class="notification" id="notification"></div>

        <!-- Main Store View -->
        <div id="storeView" class="store-container">
            <div class="store-header">
                <h1>üîí Jowaki Security Store</h1>
                <p>Professional Security Solutions & Equipment</p>
            </div>

            <div class="store-nav">
                <button class="nav-btn active" onclick="filterProducts('all')">All Products</button>
                <button class="nav-btn" onclick="filterProducts('fencing')">Electric Fencing</button>
                <button class="nav-btn" onclick="filterProducts('alarms')">Alarm Systems</button>
                <button class="nav-btn" onclick="filterProducts('cctv')">CCTV</button>
                <button class="nav-btn" onclick="filterProducts('gates')">Gates</button>
                <button class="nav-btn" onclick="filterProducts('razor')">Razor Wire</button>
            </div>

            <div class="products-grid" id="productsGrid">
                <!-- Products will be loaded here -->
            </div>
        </div>

       

        
                

        <!-- Cart -->
        <div class="cart-container" onclick="toggleCart()">
            üõí
            <span class="cart-count" id="cartCount">0</span>
        </div>

        <div class="cart-sidebar" id="cartSidebar">
            <div class="cart-header">
                <h3>Shopping Cart</h3>
                <button onclick="toggleCart()" class="btn btn-secondary">‚úï</button>
            </div>
            <div class="cart-items" id="cartItems">
                <p style="text-align: center; padding: 20px; color: #7f8c8d;">Your cart is empty</p>
            </div>
            <div class="cart-total" id="cartTotal">
                <div class="cart-summary">
                    <p><span>Subtotal:</span> <span id="cartSubtotal">KSh 0</span></p>
                    <p><span>Tax (16%):</span> <span id="cartTax">KSh 0</span></p>
                    <p><strong>Total:</strong> <strong id="cartTotalAmount">KSh 0</strong></p>
                </div>
                <button class="btn btn-primary" onclick="startCheckout()" style="width: 100%; margin-top: 15px;">Checkout</button>
                <button class="btn btn-clear-cart" onclick="clearCart()" style="width: 100%; margin-top: 10px;">Clear Cart</button>
            </div>
        </div>
    </div>

    <!-- Checkout Modal -->
    <div id="checkoutModal" class="modal hidden">
        <div class="modal-content">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem;">
                <h2>Checkout</h2>
                <button onclick="hideCheckout()" class="btn btn-secondary">‚úï</button>
            </div>
            
            <div class="checkout-steps">
                <div class="step active" id="step1">1. Customer Info</div>
                <div class="step" id="step2">2. Delivery</div>
                <div class="step" id="step3">3. Payment</div>
                <div class="step" id="step4">4. Confirmation</div>
            </div>

            <div id="checkoutContent">
                <!-- Checkout content will be loaded here -->
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <div class="footer-container">
            <div class="footer-content">
                <div class="footer-section">
                    <h3>üîí Jowaki Security</h3>
                    <p>Your trusted partner for comprehensive security solutions. Protecting what matters most since 2010.</p>
                </div>
                <div class="footer-section">
                    <h3>Contact Info</h3>
                    <p>üìû +254 721442248</p>
                    <p>üìß JowakiElectricalsrvs@gmail.com</p>
                    <p>üìç Nairobi, Kenya</p>
                </div>
                <div class="footer-section">
                    <h3>Services</h3>
                    <a href="#" onclick="showServices()">Electric Fencing</a>
                    <a href="#" onclick="showServices()">CCTV Systems</a>
                    <a href="#" onclick="showServices()">Alarm Systems</a>
                    <a href="#" onclick="showServices()">Automated Gates</a>
                </div>
                <div class="footer-section">
                    <h3>Quick Links</h3>
                    <a href="#" onclick="showHome()">Home</a>
                    <a href="#" onclick="showAbout()">About Us</a>
                    <a href="#" onclick="showServices()">Services</a>
                    <a href="#">Contact</a>
                </div>
            </div>
            <div class="footer-bottom">
                <p>¬© 2025 Jowaki Security Store. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <script>
        let products = [
            {
                id: 1,
                name: "Complete Electric Fence Kit",
                description: "Professional electric fencing solution with energizer, wire, and insulators. Perfect for residential and commercial security.",
                price: 25000,
                originalPrice: 30000,
                category: "fencing",
                stock: 15,
                active: true,
                image: "üîå",
                features: ["12V Energizer", "200m Wire", "50 Insulators", "Warning Signs"],
                specifications: {
                    "Power": "12V DC",
                    "Coverage": "Up to 200m",
                    "Voltage": "6000V Output"
                }
            },
            {
                id: 2,
                name: "4K CCTV Security Camera",
                description: "Ultra HD 4K security camera with night vision and motion detection. Weather-resistant design.",
                price: 12000,
                originalPrice: 15000,
                category: "cctv",
                stock: 8,
                active: true,
                image: "üìπ",
                features: ["4K Resolution", "Night Vision", "Motion Detection", "Weather Proof"],
                specifications: {
                    "Resolution": "4K (3840x2160)",
                    "Storage": "Cloud/Local",
                    "Connectivity": "WiFi/Ethernet"
                }
            },
            {
                id: 3,
                name: "Smart Alarm System",
                description: "Complete wireless alarm system with smartphone app control and 24/7 monitoring.",
                price: 18000,
                originalPrice: 22000,
                category: "alarms",
                stock: 12,
                active: true,
                image: "üö®",
                features: ["Wireless Sensors", "Mobile App", "24/7 Monitoring", "Battery Backup"],
                specifications: {
                    "Sensors": "10 Wireless Sensors",
                    "Battery": "24hr Backup",
                    "Connectivity": "GSM/WiFi"
                }
            },
            {
                id: 4,
                name: "Automatic Gate Motor",
                description: "Heavy-duty automatic gate motor with remote control. Suitable for swing and sliding gates.",
                price: 35000,
                originalPrice: 40000,
                category: "gates",
                stock: 5,
                active: true,
                image: "üö™",
                features: ["Remote Control", "Manual Override", "Safety Sensors", "Weather Resistant"],
                specifications: {
                    "Power": "220V AC",
                    "Weight Capacity": "400kg",
                    "Opening Speed": "12cm/s"
                }
            },
            {
                id: 5,
                name: "Razor Wire Coil",
                description: "High-quality galvanized razor wire for maximum security perimeter protection.",
                price: 3500,
                category: "razor",
                stock: 25,
                active: true,
                image: "üó°Ô∏è",
                features: ["Galvanized Steel", "450mm Diameter", "Weather Resistant", "Easy Installation"],
                specifications: {
                    "Material": "Galvanized Steel",
                    "Length": "10 meters",
                    "Blade Type": "Short Barb"
                }
            }
        ];

        let cart = [];
        let currentFilter = 'all';
        let currentCheckoutStep = 1;
        let customerInfo = {};
        let orderData = {};

        // Initialize the store
        document.addEventListener('DOMContentLoaded', function() {
            loadProducts();
            updateCartDisplay();
            
            const savedCart = JSON.parse(localStorage.getItem('cart') || '[]');
            if (savedCart.length > 0) {
                cart = savedCart;
                updateCartDisplay();
            }

            document.getElementById('searchInput').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    searchProducts();
                }
            });
        });

        // Navigation functions
        function showHome() {
            document.getElementById('storeView').classList.remove('hidden');
            document.getElementById('aboutView').classList.add('hidden');
            document.getElementById('servicesView').classList.add('hidden');
            if (event) event.preventDefault();
        }

        function showAbout() {
            document.getElementById('storeView').classList.add('hidden');
            document.getElementById('aboutView').classList.remove('hidden');
            document.getElementById('servicesView').classList.add('hidden');
            if (event) event.preventDefault();
        }

        function showServices() {
            document.getElementById('storeView').classList.add('hidden');
            document.getElementById('aboutView').classList.add('hidden');
            document.getElementById('servicesView').classList.remove('hidden');
            if (event) event.preventDefault();
        }

        // Product management functions
        function loadProducts(filteredProducts = products.filter(p => p.active)) {
            const grid = document.getElementById('productsGrid');
            grid.innerHTML = '';

            if (filteredProducts.length === 0) {
                grid.innerHTML = '<p style="text-align: center; color: #2c3e50; grid-column: 1/-1;">No products found</p>';
                return;
            }

            filteredProducts.forEach(product => {
                const productCard = document.createElement('div');
                productCard.className = 'product-card';
                
                const priceHtml = product.originalPrice ? 
                    `<div class="product-price">
                        <span class="original-price">KSh ${product.originalPrice.toLocaleString()}</span>
                        KSh ${product.price.toLocaleString()}
                    </div>` :
                    `<div class="product-price">KSh ${product.price.toLocaleString()}</div>`;

                productCard.innerHTML = `
                    <div class="product-image">
                        ${product.image}
                    </div>
                    <div class="product-info">
                        <h3 class="product-title">${product.name}</h3>
                        <p class="product-description">${product.description}</p>
                        ${priceHtml}
                        <div class="product-actions">
                            <button class="btn btn-primary" onclick="addToCart(${product.id})" ${product.stock <= 0 ? 'disabled' : ''}>
                                ${product.stock <= 0 ? 'Out of Stock' : 'Add to Cart'}
                            </button>
                            <button class="btn btn-secondary" onclick="viewProduct(${product.id})">Details</button>
                        </div>
                    </div>
                `;
                grid.appendChild(productCard);
            });
        }

        function filterProducts(category) {
            currentFilter = category;
            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            const filteredProducts = category === 'all' 
                ? products.filter(p => p.active) 
                : products.filter(p => p.category === category && p.active);
            loadProducts(filteredProducts);
        }

        function searchProducts() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase().trim();
            if (!searchTerm) {
                filterProducts(currentFilter);
                return;
            }

            const filteredProducts = products.filter(product => 
                (product.name.toLowerCase().includes(searchTerm) ||
                product.description.toLowerCase().includes(searchTerm) ||
                product.category.toLowerCase().includes(searchTerm)) &&
                product.active
            );
            loadProducts(filteredProducts);
            showNotification(`Found ${filteredProducts.length} products matching "${searchTerm}"`);
        }

        function viewProduct(productId) {
            const product = products.find(p => p.id === productId);
            if (!product) return;

            const featuresHtml = product.features ? 
                `<h4>Features:</h4><ul>${product.features.map(f => `<li>${f}</li>`).join('')}</ul>` : '';
            
            const specsHtml = product.specifications ? 
                `<h4>Specifications:</h4><ul>${Object.entries(product.specifications).map(([key, value]) => `<li><strong>${key}:</strong> ${value}</li>`).join('')}</ul>` : '';

            const modalContent = `
                <div style="text-align: center;">
                    <div style="font-size: 4rem; margin-bottom: 1rem;">${product.image}</div>
                    <h2>${product.name}</h2>
                    <p style="color: #7f8c8d; margin-bottom: 1rem;">${product.description}</p>
                    <div style="font-size: 1.5rem; color: #e74c3c; font-weight: bold; margin-bottom: 1rem;">
                        ${product.originalPrice ? `<span style="text-decoration: line-through; color: #95a5a6; font-size: 1rem;">KSh ${product.originalPrice.toLocaleString()}</span> ` : ''}
                        KSh ${product.price.toLocaleString()}
                    </div>
                    <p><strong>Stock:</strong> ${product.stock} units available</p>
                    ${featuresHtml}
                    ${specsHtml}
                    <div style="margin-top: 2rem;">
                        <button class="btn btn-primary" onclick="addToCart(${product.id}); hideModal('productModal');" ${product.stock <= 0 ? 'disabled' : ''} style="margin-right: 1rem;">
                            ${product.stock <= 0 ? 'Out of Stock' : 'Add to Cart'}
                        </button>
                        <button class="btn btn-secondary" onclick="hideModal('productModal')">Close</button>
                    </div>
                </div>
            `;

            showModal('Product Details', modalContent, 'productModal');
        }

        // Cart functions
        function addToCart(productId, quantity = 1) {
            const product = products.find(p => p.id === productId);
            if (!product || product.stock <= 0) {
                showNotification(`${product ? product.name : 'Product'} is out of stock!`, 'error');
                return;
            }

            const existingItem = cart.find(item => item.id === productId);
            
            if (existingItem) {
                if (existingItem.quantity + quantity > product.stock) {
                    showNotification(`Cannot add more ${product.name} - only ${product.stock} in stock!`, 'error');
                    return;
                }
                existingItem.quantity += quantity;
            } else {
                cart.push({
                    id: productId,
                    name: product.name,
                    price: product.price,
                    quantity: quantity,
                    image: product.image
                });
            }

            updateCartDisplay();
            saveCart();
            showNotification(`${product.name} added to cart!`);
        }

        function removeFromCart(productId) {
            cart = cart.filter(item => item.id !== productId);
            updateCartDisplay();
            saveCart();
            showNotification('Item removed from cart');
        }

        function updateQuantity(productId, change) {
            const item = cart.find(item => item.id === productId);
            const product = products.find(p => p.id === productId);
            
            if (!item || !product) return;

            const newQuantity = item.quantity + change;
            
            if (newQuantity <= 0) {
                removeFromCart(productId);
                return;
            }

            if (newQuantity > product.stock) {
                showNotification(`Cannot add more ${product.name} - only ${product.stock} in stock!`, 'error');
                return;
            }

            item.quantity = newQuantity;
            updateCartDisplay();
            saveCart();
        }

        function clearCart() {
            if (cart.length === 0) {
                showNotification('Cart is already empty!', 'error');
                return;
            }
            
            if (confirm('Are you sure you want to clear your cart?')) {
                cart = [];
                updateCartDisplay();
                saveCart();
                showNotification('Cart cleared successfully!');
            }
        }

        function updateCartDisplay() {
            const cartCount = document.getElementById('cartCount');
            const cartItems = document.getElementById('cartItems');
            const cartSubtotal = document.getElementById('cartSubtotal');
            const cartTax = document.getElementById('cartTax');
            const cartTotalAmount = document.getElementById('cartTotalAmount');

            const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);
            cartCount.textContent = totalItems;
            cartCount.style.display = totalItems > 0 ? 'flex' : 'none';

            if (cart.length === 0) {
                cartItems.innerHTML = '<p style="text-align: center; padding: 20px; color: #7f8c8d;">Your cart is empty</p>';
            } else {
                cartItems.innerHTML = cart.map(item => `
                    <div class="cart-item">
                        <div class="cart-item-image">${item.image}</div>
                        <div class="cart-item-info">
                            <div class="cart-item-name">${item.name}</div>
                            <div class="cart-item-price">KSh ${(item.price * item.quantity).toLocaleString()}</div>
                        </div>
                        <div class="cart-item-controls">
                            <button class="quantity-btn" onclick="updateQuantity(${item.id}, -1)">‚àí</button>
                            <span>${item.quantity}</span>
                            <button class="quantity-btn" onclick="updateQuantity(${item.id}, 1)">+</button>
                            <button class="btn btn-secondary" onclick="removeFromCart(${item.id})" style="margin-left: 0.5rem; padding: 0.25rem 0.5rem;">√ó</button>
                        </div>
                    </div>
                `).join('');
            }

            const subtotal = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            const tax = subtotal * 0.16;
            const total = subtotal + tax;
            
            cartSubtotal.textContent = `KSh ${subtotal.toLocaleString()}`;
            cartTax.textContent = `KSh ${Math.round(tax).toLocaleString()}`;
            cartTotalAmount.textContent = `KSh ${Math.round(total).toLocaleString()}`;
        }

        function toggleCart() {
            const cartSidebar = document.getElementById('cartSidebar');
            cartSidebar.classList.toggle('open');
        }

        function saveCart() {
            localStorage.setItem('cart', JSON.stringify(cart));
        }

        // Modal functions
        function showModal(title, content, modalId) {
            const modal = document.createElement('div');
            modal.className = 'modal';
            modal.id = modalId;
            modal.innerHTML = `
                <div class="modal-content">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem;">
                        <h2>${title}</h2>
                        <button onclick="hideModal('${modalId}')" class="btn btn-secondary">‚úï</button>
                    </div>
                    ${content}
                </div>
            `;
            document.getElementById('app').appendChild(modal);
        }

        function hideModal(modalId) {
            const modal = document.getElementById(modalId);
            if (modal) modal.remove();
        }

        // Checkout functions
        function startCheckout() {
            if (cart.length === 0) {
                showNotification('Your cart is empty!', 'error');
                return;
            }
            
            currentCheckoutStep = 1;
            customerInfo = {};
            document.getElementById('checkoutModal').classList.remove('hidden');
            showCheckoutStep(1);
        }

        function hideCheckout() {
            document.getElementById('checkoutModal').classList.add('hidden');
        }

        function showCheckoutStep(step) {
            currentCheckoutStep = step;
            
            document.querySelectorAll('.step').forEach((stepEl, index) => {
                stepEl.classList.toggle('active', index + 1 === step);
            });

            let content = '';
            
            switch(step) {
                case 1:
                    content = getCustomerInfoStep();
                    break;
                case 2:
                    content = getDeliveryStep();
                    break;
                case 3:
                    content = getPaymentStep();
                    break;
                case 4:
                    content = getConfirmationStep();
                    break;
            }
            
            document.getElementById('checkoutContent').innerHTML = content;

            if (step === 3) {
                const paymentMethods = document.querySelectorAll('.payment-method');
                paymentMethods.forEach(method => {
                    method.addEventListener('click', function() {
                        paymentMethods.forEach(m => m.classList.remove('selected'));
                        this.classList.add('selected');
                        document.getElementById('paymentBtn').disabled = false;
                    });
                });
            }
        }

        function getCustomerInfoStep() {
            return `
                <div class="checkout-section">
                    <h3>Customer Information</h3>
                    <form onsubmit="saveCustomerInfo(event)">
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                            <div class="form-group">
                                <label>First Name*</label>
                                <input type="text" name="firstName" value="${customerInfo.firstName || ''}" required>
                            </div>
                            <div class="form-group">
                                <label>Last Name*</label>
                                <input type="text" name="lastName" value="${customerInfo.lastName || ''}" required>
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Email Address*</label>
                            <input type="email" name="email" value="${customerInfo.email || ''}" required>
                        </div>
                        <div class="form-group">
                            <label>Phone Number*</label>
                            <input type="tel" name="phone" value="${customerInfo.phone || ''}" pattern="[0-9]{10,12}" required>
                        </div>
                        <div class="form-group">
                            <label>Address*</label>
                            <textarea name="address" rows="3" required>${customerInfo.address || ''}</textarea>
                        </div>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                            <div class="form-group">
                                <label>City*</label>
                                <input type="text" name="city" value="${customerInfo.city || ''}" required>
                            </div>
                            <div class="form-group">
                                <label>Postal Code</label>
                                <input type="text" name="postalCode" value="${customerInfo.postalCode || ''}">
                            </div>
                        </div>
                        <button type="submit" class="btn btn-primary">Continue to Delivery</button>
                    </form>
                </div>
            `;
        }

        function getDeliveryStep() {
            return `
                <div class="checkout-section">
                    <h3>Delivery Options</h3>
                    <form onsubmit="saveDeliveryInfo(event)">
                        <div class="form-group">
                            <label>Delivery Method*</label>
                            <div style="margin-top: 0.5rem;">
                                <label style="display: flex; align-items: center; margin-bottom: 0.5rem;">
                                    <input type="radio" name="deliveryMethod" value="standard" ${customerInfo.deliveryMethod === 'standard' ? 'checked' : ''} required style="margin-right: 0.5rem;">
                                    Standard Delivery (3-5 business days) - FREE
                                </label>
                                <label style="display: flex; align-items: center; margin-bottom: 0.5rem;">
                                    <input type="radio" name="deliveryMethod" value="express" ${customerInfo.deliveryMethod === 'express' ? 'checked' : ''} style="margin-right: 0.5rem;">
                                    Express Delivery (1-2 business days) - KSh 500
                                </label>
                                <label style="display: flex; align-items: center; margin-bottom: 0.5rem;">
                                    <input type="radio" name="deliveryMethod" value="pickup" ${customerInfo.deliveryMethod === 'pickup' ? 'checked' : ''} style="margin-right: 0.5rem;">
                                    Store Pickup - FREE
                                </label>
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Delivery Instructions (Optional)</label>
                            <textarea name="deliveryInstructions" rows="3" placeholder="Any special delivery instructions...">${customerInfo.deliveryInstructions || ''}</textarea>
                        </div>
                        <div style="display: flex; gap: 1rem;">
                            <button type="button" class="btn btn-secondary" onclick="showCheckoutStep(1)">Back</button>
                            <button type="submit" class="btn btn-primary">Continue to Payment</button>
                        </div>
                    </form>
                </div>
            `;
        }

        function getPaymentStep() {
            const subtotal = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            const deliveryFee = customerInfo.deliveryMethod === 'express' ? 500 : 0;
            const tax = subtotal * 0.16;
            const total = subtotal + deliveryFee + tax;

            return `
                <div class="checkout-section">
                    <h3>Payment Method</h3>
                    <div class="payment-methods">
                        <div class="payment-method" onclick="selectPaymentMethod('mpesa')">
                            <div style="font-size: 2rem;">üì±</div>
                            <h4>M-Pesa</h4>
                            <p>Pay via M-Pesa</p>
                        </div>
                        <div class="payment-method" onclick="selectPaymentMethod('card')">
                            <div style="font-size: 2rem;">üí≥</div>
                            <h4>Credit/Debit Card</h4>
                            <p>Visa, Mastercard</p>
                        </div>
                        <div class="payment-method" onclick="selectPaymentMethod('bank')">
                            <div style="font-size: 2rem;">üè¶</div>
                            <h4>Bank Transfer</h4>
                            <p>Direct bank transfer</p>
                        </div>
                        <div class="payment-method" onclick="selectPaymentMethod('cod')">
                            <div style="font-size: 2rem;">üí∞</div>
                            <h4>Cash on Delivery</h4>
                            <p>Pay when you receive</p>
                        </div>
                    </div>
                    
                    <div class="order-summary">
                        <h4>Order Summary</h4>
                        ${cart.map(item => `
                            <div class="order-item">
                                <span>${item.name} x${item.quantity}</span>
                                <span>KSh ${(item.price * item.quantity).toLocaleString()}</span>
                            </div>
                        `).join('')}
                        <div class="order-item">
                            <span>Subtotal</span>
                            <span>KSh ${subtotal.toLocaleString()}</span>
                        </div>
                        <div class="order-item">
                            <span>Delivery</span>
                            <span>KSh ${deliveryFee.toLocaleString()}</span>
                        </div>
                        <div class="order-item">
                            <span>Tax (16%)</span>
                            <span>KSh ${Math.round(tax).toLocaleString()}</span>
                        </div>
                        <div class="order-item" style="border-top: 2px solid #e74c3c; padding-top: 0.5rem; font-weight: bold;">
                            <span>Total</span>
                            <span>KSh ${Math.round(total).toLocaleString()}</span>
                        </div>
                    </div>
                    
                    <div style="display: flex; gap: 1rem; margin-top: 1rem;">
                        <button type="button" class="btn btn-secondary" onclick="showCheckoutStep(2)">Back</button>
                        <button type="button" class="btn btn-primary" onclick="processPayment()" disabled id="paymentBtn">Select Payment Method</button>
                    </div>
                </div>
            `;
        }

        function getConfirmationStep() {
            const orderNumber = 'JWK' + Date.now().toString().slice(-6);
            
            return `
                <div class="checkout-section" style="text-align: center;">
                    <div style="font-size: 4rem; color: #2ecc71; margin-bottom: 1rem;">‚úÖ</div>
                    <h2 style="color: #2ecc71; margin-bottom: 1rem;">Order Confirmed!</h2>
                    <p style="font-size: 1.2rem; margin-bottom: 2rem;">Thank you for your order, ${customerInfo.firstName}!</p>
                    
                    <div style="background: #f9f9f9; padding: 1.5rem; border-radius: 10px; margin-bottom: 2rem;">
                        <h3>Order Details</h3>
                        <p><strong>Order Number:</strong> ${orderNumber}</p>
                        <p><strong>Email:</strong> ${customerInfo.email}</p>
                        <p><strong>Phone:</strong> ${customerInfo.phone}</p>
                        <p><strong>Delivery:</strong> ${customerInfo.deliveryMethod}</p>
                        <p><strong>Payment:</strong> ${customerInfo.paymentMethod}</p>
                    </div>
                    
                    <p style="margin-bottom: 2rem;">We'll send you an email confirmation shortly. You can track your order status by calling us at +254 721442248.</p>
                    <button class="btn btn-primary" onclick="completeOrder()">Continue Shopping</button>
                </div>
            `;
        }

        function saveCustomerInfo(event) {
            event.preventDefault();
            const formData = new FormData(event.target);
            customerInfo = {
                firstName: formData.get('firstName'),
                lastName: formData.get('lastName'),
                email: formData.get('email'),
                phone: formData.get('phone'),
                address: formData.get('address'),
                city: formData.get('city'),
                postalCode: formData.get('postalCode')
            };
            showCheckoutStep(2);
        }

        function saveDeliveryInfo(event) {
            event.preventDefault();
            const formData = new FormData(event.target);
            customerInfo.deliveryMethod = formData.get('deliveryMethod');
            customerInfo.deliveryInstructions = formData.get('deliveryInstructions');
            showCheckoutStep(3);
        }

        function selectPaymentMethod(method) {
            customerInfo.paymentMethod = method;
            const paymentMethods = document.querySelectorAll('.payment-method');
            paymentMethods.forEach(m => m.classList.remove('selected'));
            event.currentTarget.classList.add('selected');
            document.getElementById('paymentBtn').disabled = false;
        }

        function processPayment() {
            if (!customerInfo.paymentMethod) {
                showNotification('Please select a payment method', 'error');
                return;
            }
            showCheckoutStep(4);
        }

        function completeOrder() {
            cart = [];
            saveCart();
            updateCartDisplay();
            hideCheckout();
            showNotification('Order placed successfully!');
            showHome();
        }

        function showNotification(message, type = 'success') {
            const notification = document.getElementById('notification');
            notification.textContent = message;
            notification.className = `notification ${type} show`;
            setTimeout(() => {
                notification.className = 'notification';
            }, 3000);
        }
    </script>
</body>
</html>